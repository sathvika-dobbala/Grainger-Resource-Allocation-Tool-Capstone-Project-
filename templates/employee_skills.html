<!DOCTYPE html>
<html>
<head>
    <title>{{ emp['firstname'] }} {{ emp['lastname'] }} - Skills</title>
</head>
<body>
    <h1>Skills for {{ emp['firstname'] }} {{ emp['lastname'] }}</h1>

<table border="1">
    <tr><th>Skill</th><th>Proficiency</th><th>Evidence</th><th>Actions</th></tr>
    {% for s in skills %}
    <tr>
        <!-- Update Form -->
        <form method="POST" 
              action="{{ url_for('edit_skill', emp_id=emp_id, skill_id=s['skillID']) }}" 
              onsubmit="return confirmUpdate()">
            <td>{{ s['skillName'] }}</td>
            <td>
                <input type="number" name="profiencylevel" min="1" max="10" value="{{ s['profiencylevel'] }}">
            </td>
            <td>
                <input type="text" name="evidence" value="{{ s['evidence'] }}">
            </td>
            <td>
                <button type="submit">Update</button>
        </form>

        <!-- Delete Form -->
        <form method="POST" 
              action="{{ url_for('delete_skill', emp_id=emp_id, skill_id=s['skillID']) }}" 
              style="display:inline;" 
              onsubmit="return confirmDelete('{{ s['skillName'] }}')">
            <button type="submit">Delete</button>
        </form>
            </td>
    </tr>
    {% endfor %}
</table>

<h2>Add A New Skill</h2>
<form method="POST">
    <label>Skill Name:</label>
    <input type="text" name="skillName" required><br><br>

    <label>Proficiency (1–10):</label>
    <input type="number" name="profiencylevel" min="1" max="10" required><br><br>

    <label>Evidence:</label>
    <input type="text" name="evidence" placeholder="e.g., Completed certification"><br><br>

    <button type="submit">Save Skill</button>
</form>

<p><a href="/">Back to Employee Directory</a></p>

<!-- JavaScript for popup messages -->
<script>
function confirmUpdate() {
    alert("✅ Skill updated successfully!");
    return true; // let the form submit
}

function confirmDelete(skillName) {
    return confirm("❌ Are you sure you want to delete the skill: " + skillName + "?");
}
</script>

</body>
</html>
